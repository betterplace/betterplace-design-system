import { Canvas, Meta, Story, ArgsTable, Source } from '@storybook/addon-docs'
import dedent from 'ts-dedent'
import { useForm } from './use_form'
import { useUseFormReturn } from './use_use_form_return.tsx'
import { useUseFormReturnRegister } from './use_use_form_return_register.tsx'
import { Template } from './use_form_story_template.tsx'

<Meta
  title="Hooks/Form/useForm"
  component={useForm}
  parameters={{
    viewMode: 'docs',
    previewTabs: {
      canvas: { hidden: true },
    },
  }}
/>

# useForm

## Example

<Canvas>
  <Story
    name="useForm Example"
    args={{
      onSubmit: (values) => Promise.resolve(values),
      onFormValuesChange: (values) => console.log(values),
      onValidate: (_) => Promise.resolve({ foo: 'Required' }),
      initialValues: { foo: '', baz: true },
      autoSubmit: false,
    }}
  >
    {Template.bind({})}
  </Story>
</Canvas>

## Usage

### Without provider

<Source
  language="tsx"
  code={dedent`
type FormValues = { foo: string; bar: number }
const MyComponent = () => {
    const onSubmit = useCallback(async (values: FormValues) =>
        await fetch('/my/api', { method: 'POST' }),
    [])
    const formProps = useForm({ onSubmit })
    return (
      <form {...formProps}>
        <input {...register({
           type: 'text',
           name: 'foo'
        })} />
        ....
      </form>
    )
}
`}
  format={false}
/>

## Props

<ArgsTable of={useForm} />

## Return

<ArgsTable of={useUseFormReturn} />

## RegisterFn

<ArgsTable of={useUseFormReturnRegister} />
