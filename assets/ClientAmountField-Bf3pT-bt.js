import{j as J}from"./jsx-runtime-BlAj40OV.js";import{c as O}from"./index-Bl6ORisp.js";import{r as a}from"./index-Cs7sjTYM.js";import{T as Q}from"./TextInput-CJQ35zCQ.js";const X=(r,e)=>Number(r==="en"?String(e).replace(/[^0-9.]/g,""):String(e).replace(/[^0-9,]/g,"").replace(/,/g,".")),k={},Y=(r,e,t,i)=>{const c=`${r}-${e?"currency":"noCurrency"}-${t}-${i}`;let s=k[c];return s||(s=new Intl.NumberFormat(r??"de",{minimumFractionDigits:t,maximumFractionDigits:t,...e?{style:"currency",currency:"EUR"}:{},...i?{}:{useGrouping:!1}}),k[c]=s),s};function P(r,e,t={}){const i=(t==null?void 0:t.precision)===void 0?2:t==null?void 0:t.precision,d=typeof e=="number"?e||0:X(r,e),c=(t==null?void 0:t.thousandSeparator)??!0;return Y(r,!(t!=null&&t.format),i,c).format(d).replace(/\u00A0/,"â€¯")}function z(r){if(!r)return 0;const e=r.replace(/,/g,"."),t=parseFloat(e)||0;return Math.round(t*100)}function h(r,e=2){return r.replace(/[^\d.,]/g,"").replace(/^([.,]{1,1})/,"0$1").replace(/^0{2,}/,"0").replace(/^0([\d]+)([\d,.]*)/,"$1$2").replace(/[.,]([^.,]*)(?=[.,])/g,"$1").replace(new RegExp(`([.,]\\d{${e}}).*$`),"$1")}const Z="_hideSteps_fdmq0_1",B={hideSteps:Z};function A(r){if(typeof r>"u")return;let e;if(typeof r!="number"?e=parseFloat(r):e=r,!isNaN(e))return Math.round(e*100)}const j=a.forwardRef(({label:r,locale:e="de",name:t,id:i,min:d=0,onChange:c,onBlur:s,onFocus:f,defaultValue:m,value:g,step:N,children:w,className:D,hideSteps:T,max:R,...K},p)=>{const o=a.useMemo(()=>V(N),[N]),[l,$]=a.useState(h(P(e,g??m??"",{precision:o,format:"%v",thousandSeparator:!1}),o)),b=a.useMemo(()=>A(R),[R]),M=a.useMemo(()=>A(d),[d]),[y,S]=a.useState(null),x=a.useRef(null),L=a.useCallback(n=>{if(x.current=n,!!p){if(typeof p=="function")return p(n);p.current=n}},[p]),U=a.useCallback(n=>{const u=I(n.target.value,e,o),F=z(u);if(typeof b<"u"&&F>b||typeof M<"u"&&F<M){const H=n.target.selectionStart?n.target.selectionStart:0;return S(H),n.preventDefault()}S(n.target.selectionStart);let C=n.target.value;u.startsWith(n.target.value)||(C=u);const E=z(n.target.value);n.target.value&&!isNaN(E)&&F===E&&(c==null||c(n)),$(C)},[e,o,M,b,c]),q=a.useCallback(n=>{const u=I(n.target.value,e,o);u!==n.target.value&&(n.target.value=u),S(null),s==null||s(n)},[s,o,e]),W=a.useCallback(n=>{S(n.target.selectionStart),f==null||f(n)},[f]),G=a.useMemo(()=>m?{defaultValue:l}:{value:l},[m,l]);return a.useEffect(()=>{if(typeof m<"u")return;const n=g??m;if(typeof g>"u")return $("");const u=h(P(e,n,{precision:o,format:"%v",thousandSeparator:!1}),o);$(u)},[g,o,m,e]),a.useEffect(()=>{const n=(l==null?void 0:l.length)??0,u=(y??0)>n?n:y;y===null||!x.current||document.activeElement!==x.current||x.current.setSelectionRange(u,u)},[y,l]),J.jsx(Q,{...K,...G,onFocus:W,onBlur:q,onChange:U,step:N,ref:L,id:i||t,name:t,label:r,pattern:"[0-9]*[.,]?[0-9]*",type:"text",inputMode:"decimal",className:O(D,{[B.hideSteps]:T}),children:w})});j.displayName="ClientAmountField";function I(r,e,t=2){if(typeof r>"u"||r===null)return r;const i=String(r),d=h(i,t),c=P(e,d,{precision:t,format:"%v",thousandSeparator:!1}),s=h(c,t);if(!t)return s;const f=s.search(/[.,]/);if(f<0)return s;const m=t-(s.length-1-f);return s.concat("0".repeat(m))}function V(r){var t;return r===void 0?void 0:((t=String(r).split(".")[1])==null?void 0:t.length)??0}const rt=j;export{rt as A};
